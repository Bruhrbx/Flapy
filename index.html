<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Flapy Razka</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
 overflow:hidden;
 font-family:Arial;
 background:#3aaeff;
}

/* ===== MENU ===== */
#menu{
 position:fixed;inset:0;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 gap:12px;
 background:#3aaeff;
 z-index:10;
 color:white;
}
#menu h1{font-size:48px}
#lastScore{font-size:20px;opacity:.9}

#menu select,#menu button{
 font-size:20px;
 padding:12px 30px;
 border-radius:10px;
 border:none;
}
#menu button{
 background:#2ecc71;
 color:white;
}

/* ===== SCORE ===== */
#score{
 position:fixed;
 top:20px;
 left:50%;
 transform:translateX(-50%);
 font-size:36px;
 color:white;
 text-shadow:2px 2px 4px #000;
 display:none;
 z-index:5;
}

/* ===== PAUSE ===== */
#pauseText{
 position:fixed;
 inset:0;
 display:none;
 justify-content:center;
 align-items:center;
 font-size:48px;
 color:white;
 background:rgba(0,0,0,.4);
 z-index:15;
}

/* ===== GAME ===== */
#game{
 position:fixed;
 inset:0;
 display:none;
 overflow:hidden;
 background:#3aaeff;
}

#bird{
 position:absolute;
 width:48px;
 height:48px;
 left:20%;
 transform-origin:center;
 transition:transform .1s linear;
}

.pipe{
 position:absolute;
 width:80px;
 background:#2ecc71;
}
.pipe.top{top:0}
.pipe.bottom{bottom:0}

/* ===== GAME OVER VIDEO ===== */
#gameover{
 position:fixed;
 inset:0;
 display:none;
 background:black;
 z-index:20;
}
#gameover video{
 width:100%;
 height:100%;
 object-fit:cover;
}
</style>
</head>

<body>

<!-- MENU -->
<div id="menu">
 <h1>üê¶ Flapy Razka</h1>
 <div id="lastScore">Last Score: 0</div>

 <select id="mode">
  <option value="easy">Easy</option>
  <option value="normal" selected>Normal</option>
  <option value="hard">Hard</option>
 </select>

 <button id="startBtn">START</button>
</div>

<!-- SCORE -->
<div id="score">0</div>

<!-- PAUSE -->
<div id="pauseText">‚è∏ PAUSED</div>

<!-- GAME -->
<div id="game">
 <img id="bird" src="p.png">
</div>

<!-- GAME OVER VIDEO -->
<div id="gameover">
 <video id="overVideo" src="over.mp4"></video>
</div>

<script>
const menu = document.getElementById("menu");
const game = document.getElementById("game");
const bird = document.getElementById("bird");
const scoreText = document.getElementById("score");
const startBtn = document.getElementById("startBtn");
const modeSelect = document.getElementById("mode");
const lastScoreText = document.getElementById("lastScore");
const pauseText = document.getElementById("pauseText");

const gameover = document.getElementById("gameover");
const overVideo = document.getElementById("overVideo");

let birdY, velocity, gravity, lift, pipeSpeed;
let pipes = [];
let score = 0;
let lastScore = 0;
let running = false;
let paused = false;
let spawnChance = 0.02;

/* ===== START GAME ===== */
startBtn.onclick = () => {
 const mode = modeSelect.value;

 if(mode==="easy"){ gravity=0.4; lift=-6; pipeSpeed=2.5; spawnChance=0.015; }
 if(mode==="normal"){ gravity=0.45; lift=-6.5; pipeSpeed=3; spawnChance=0.018; }
 if(mode==="hard"){ gravity=0.5; lift=-7; pipeSpeed=3.5; spawnChance=0.022; }

 menu.style.display="none";
 game.style.display="block";
 scoreText.style.display="block";
 pauseText.style.display="none";

 birdY = innerHeight/2;
 velocity = 0;
 score = 0;
 pipes.forEach(p=>{p.top.remove();p.bottom.remove()});
 pipes=[];
 running=true;
 paused=false;
 scoreText.innerText=0;

 loop();
};

/* ===== PIPE ===== */
function createPipe(){
 const gap = Math.random()*90 + 230;
 const topH = Math.random()*(innerHeight-gap-120) + 60;

 const top = document.createElement("div");
 top.className="pipe top";
 top.style.height=topH+"px";
 top.style.left=innerWidth+"px";

 const bottom = document.createElement("div");
 bottom.className="pipe bottom";
 bottom.style.height=(innerHeight-topH-gap)+"px";
 bottom.style.left=innerWidth+"px";

 game.append(top,bottom);
 pipes.push({top,bottom,x:innerWidth,passed:false});
}

/* ===== LOOP ===== */
function loop(){
 if(!running) return;
 if(paused){ requestAnimationFrame(loop); return; }

 velocity+=gravity;
 birdY+=velocity;
 bird.style.top=birdY+"px";

 /* ROTATION */
 let angle = Math.max(-25, Math.min(90, velocity*8));
 bird.style.transform = `rotate(${angle}deg)`;

 if(birdY<0 || birdY+48>innerHeight) return gameOver();

 pipes.forEach(p=>{
  p.x-=pipeSpeed;
  p.top.style.left=p.x+"px";
  p.bottom.style.left=p.x+"px";

  if(!p.passed && p.x < innerWidth*0.2){
   p.passed=true;
   score++;
   scoreText.innerText=score;
  }

  const b = bird.getBoundingClientRect();
  if(
   b.left < p.x+80 &&
   b.right > p.x &&
   (b.top < p.top.offsetHeight ||
    b.bottom > innerHeight-p.bottom.offsetHeight)
  ) gameOver();
 });

 pipes = pipes.filter(p=>p.x>-100);
 if(Math.random()<spawnChance) createPipe();

 requestAnimationFrame(loop);
}

/* ===== CONTROL ===== */
function flap(){
 if(running && !paused) velocity=lift;
}
addEventListener("click",flap);
addEventListener("touchstart",flap,{passive:true});
addEventListener("keydown",e=>{
 if(e.code==="Space") flap();
 if(e.code==="KeyP" && running){
  paused=!paused;
  pauseText.style.display = paused ? "flex" : "none";
 }
});

/* ===== GAME OVER ===== */
function gameOver(){
 if(!running) return;
 running=false;

 lastScore = score;
 lastScoreText.innerText = "Last Score: " + lastScore;

 game.style.display="none";
 scoreText.style.display="none";
 pauseText.style.display="none";

 gameover.style.display="block";
 overVideo.currentTime=0;
 overVideo.play();
}

/* ===== VIDEO END ===== */
overVideo.onended = () => {
 gameover.style.display="none";
 menu.style.display="flex";
};
</script>

</body>
</html>
